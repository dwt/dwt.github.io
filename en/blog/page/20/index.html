
<!doctype html>
<html lang="de">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="../../../../static/bootstrap-4.1.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="../../../../static/style.css">
    <link rel="stylesheet" href="../../../../static/pygments.css">
    <title>Blog</title>
    <link rel="alternate" type="application/atom+xml" title="RSS: Martin H√§ckers Blog Artikel" href="../../../../blog/feed.xml" />
  </head>
  <body>
    <header>
      <nav class="navbar navbar-expand-sm">
  <a href="../../../" class="navbar-brand ">üè†</a>
  <input type="checkbox" id="navbar-toggle-checkbox">
  <label for="navbar-toggle-checkbox" class="navbar-brand navbar-toggle d-sm-none float-right" aria-label="Navigation Umschalten">
    <span></span>
  </label>
  <ul class="navbar-nav collapse navbar-collapse">
    
      <li class="nav-item "><a href="../../../work/" class="nav-link">Professional software development</a></li>
    
      <li class="nav-item "><a href="../../../projects/" class="nav-link">Projects</a></li>
    
      <li class="nav-item "><a href="../../../publications/" class="nav-link">Publications and talks</a></li>
    
      <li class="nav-item active"><a href="../../" class="nav-link">Blog<span class="sr-only">(ausgew√§hlt)</span></a></li>
    
      <li class="nav-item "><a href="../../../categories/" class="nav-link">Categories</a></li>
    
    <li class="nav-item ml-auto">
      <a class=nav-link href="../../../../blog/page/20/">üá©üá™</a>
    </li>
    <li class="nav-item pull-right">
      <a class=nav-link href="./">üá¨üáß</a>
    </li>
  </ul>
</nav>
<nav class="breadcrumb">
  

  

<a class="breadcrumb-item " href="../../../">üè†</a>


<a class="breadcrumb-item active" href="./">Blog</a>

</nav>
    </header>
    <article class="page blog  container-fluid">
      
  
    
  <article class="blog-post">
    <header>
      <h2>
        <a href="../../2008/9/2008-09-05-19-08/">
        2008/09/05/19.08
        </a>
      </h2>
      <p class="meta">
        written by Martin H√§cker on <time datetime="2008-09-05">Friday, September 5, 2008</time>
      </p>
    </header>

    <section class="blog-post-body">
      <h1>Python != Funktionales Programmieren</h1>
<p>--- zumindest scheint es so.</p>
<p>Das hier zum Beispiel:</p>
<div class="hll"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># encoding: utf-8</span>

<span class="k">def</span><span class="w"> </span><span class="nf">counter_generator</span><span class="p">():</span>
    <span class="n">current_value</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">counter</span><span class="p">():</span>
        <span class="n">current_value</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">current_value</span>
    <span class="k">return</span> <span class="n">counter</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">unittest</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ClosureTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_counter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEquals</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">counter_generator</span><span class="p">()())</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</pre></div>
<p>Wenn man das ausf√ºhrt dann kriegt man den wenig aussagekr√§ftigen Fehler <strong><em>UnboundLocalError: local variable 'current_value' referenced before assignment</em></strong>. Oder mit anderen Worten: "Wiebidde?"</p>
<p>Kommentiert man <strong><em>current_value += 1</em></strong> aus, funktioniert das ganze (ok, bis auf den dann fehlschlagenden Testcase).</p>
<p>Immerhin kommt man dem Problem dann auf die Spur (ich und Felix haben das leider erst herausgefunden nachdem wir auf #python nachgefragt haben...) Python kann n√§mlich seine Scopes nicht vern√ºnftig. Das hei√üt, man kriegt keinen schreibenden Zugriff auf die Variablen eine Funktion weiter drau√üen - nur lesend. Nur dass die Fehlermeldung nat√ºrlich total mist ist.</p>
<p>Grah.</p>
<p>Interessanterweise geht diese L√∂sung auch nicht</p>
<div class="hll"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># encoding: utf-8</span>

<span class="k">def</span><span class="w"> </span><span class="nf">counter_generator</span><span class="p">():</span>
    <span class="n">workaround</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
    <span class="n">workaround</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">counter</span><span class="p">():</span>
        <span class="n">workaround</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">workaround</span><span class="o">.</span><span class="n">current_value</span>
    <span class="k">return</span> <span class="n">counter</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">unittest</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ClosureTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_counter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEquals</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">counter_generator</span><span class="p">()())</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</pre></div>
<p>F√ºr hinweise wieso bin ich dankbar.</p>
<p>Vielleicht kriegt Python dass ja irgendwann mal hin. In der Zwischenzeit hilft dieser Workaround:</p>
<div class="hll"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># encoding: utf-8</span>

<span class="k">class</span><span class="w"> </span><span class="nc">AttributableDict</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute_name</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">attribute_name</span><span class="p">]</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute_name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">[</span><span class="n">attribute_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

<span class="k">def</span><span class="w"> </span><span class="nf">counter_generator</span><span class="p">():</span>
    <span class="n">workaround</span> <span class="o">=</span> <span class="n">AttributableDict</span><span class="p">()</span>
    <span class="n">workaround</span><span class="o">.</span><span class="n">current_value</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">counter</span><span class="p">():</span>
        <span class="n">workaround</span><span class="o">.</span><span class="n">current_value</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">workaround</span><span class="o">.</span><span class="n">current_value</span>
    <span class="k">return</span> <span class="n">counter</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">unittest</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ClosureTest</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_counter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEquals</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">counter_generator</span><span class="p">()())</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">unittest</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</pre></div>

    </section>
    
      <footer>
        <a href="../../2008/9/2008-09-05-19-08/">weiterlesen‚Ä¶</a>
      </footer>
    
  </article>

  
    
  <article class="blog-post">
    <header>
      <h2>
        <a href="../../2008/9/ui-schlendrian-bei-apple-ical/">
        UI Schlendrian bei Apple iCal
        </a>
      </h2>
      <p class="meta">
        written by Martin H√§cker on <time datetime="2008-09-04">Thursday, September 4, 2008</time>
      </p>
    </header>

    <section class="blog-post-body">
      <p>iCal - ein Programm das man lieben und hassen kann.</p>
<p>Einerseits, es funktioniert gut, ist ordentlich ins System integriert - aber andererseits sowas:</p>
<p>Wenn man einen Termin bearbeitet, dann doppelklickt man ihn. Danach √∂ffnet sich dieser in einem neuen Fenster, in dem man dann noch einmal auf Bearbeiten klicken muss damit man ihn tats√§chlich ver√§ndern kann.</p>
<p>Das tolle daran: Wenn man dann irgendwann mit seinen √Ñnderungen zufrieden ist und ihn best√§tigen m√∂chte, dann stellt man fest das der "Best√§tigen" Knopf auf keinen sinnvollen Keyboard Shortcut reagiert. Enter, Return, Controll-Return, Command-Return, Alt-Return - alles voll daneben.</p>
<p>Bisher dachte ich nur: "Naja, voll nervig" aber heute ist mir aufgefallen dass sie es sogar geschafft haben dem noch die Spitze aufzusetzen: Es gibt n√§mlich doch eine Tastenkombination um die gemachten √Ñnderungen zu akzeptieren:</p>
<p>ESCAPE</p>
<p>!!!!1111!!!!(elf)!!!</p>
<p>Ich bin Sprachlos.</p>

    </section>
    
      <footer>
        <a href="../../2008/9/ui-schlendrian-bei-apple-ical/">weiterlesen‚Ä¶</a>
      </footer>
    
  </article>

  
    
  <article class="blog-post">
    <header>
      <h2>
        <a href="../../2008/9/authenticating-an-otr-user-in-adium/">
        Authenticating an OTR user in Adium
        </a>
      </h2>
      <p class="meta">
        written by Martin H√§cker on <time datetime="2008-09-03">Wednesday, September 3, 2008</time>
      </p>
    </header>

    <section class="blog-post-body">
      <p>(With many thanks to Dan Levin for his help)</p>
<p>This is what I arrived at [blog:2008/08/19/19.49 last week] as an authentication GUI:</p>
<p><img src="../../2008/9/authenticating-an-otr-user-in-adium/Dialog-based-implementation-of-the-Sociallist-Millionaire-Protocoll.png" alt="Image"></p>
<p>This GUI Design has several good and bad points - first the good ones:</p>
<ul>
<li>It tells the user exactly what he should do</li>
<li>It gives help in how to achieve that</li>
<li>It provides additional help on how to achieve this</li>
</ul>
<p>The bad ones though weigh very heavy:</p>
<ul>
<li>Its a dialog. </li>
<li>Its super text heavy</li>
<li>it looks ugly (well not because of the design, but because it has so much text in it.)</li>
</ul>
<p>The most pressing problem however is in the library support from OTR. It simply does not know what a question is.</p>
<p>This is a problem, because it makes it almost impossible to have the Question as a special entitiy in the GUI - and also that none of the synchronisation problems that this brings are adressed in the GUI. So what to do if both users start typing their own question? The other User wouldn't know - then how does the programm tell the user that his question was just overruled be the other persons and that he should provide the answer to that as the secret word?</p>
<p>There is more of course - but this is what I consider the most important.</p>
<p>Well, this is our current approach at solving these problems:</p>
<p><img src="../../2008/9/authenticating-an-otr-user-in-adium/Status-Bar-Social-Millionaire-Protocol.png" alt="Image"></p>
<p>This is what I like about this:</p>
<ul>
<li>No more dialog, it's all happening inline</li>
<li>It clearly states what goes where in clear statements</li>
<li>It tells the user in clear terms what he needs to do and how to do it</li>
<li>Only as much text as is absolutely needed</li>
<li>Provides more help should the user request it.</li>
</ul>
<p>Especially this is the most simple GUI of all the approaches that I tried.</p>
<p>I don't have finished mockups of the other aproaches (most is pen'n'paper work) but I did try having the question and answer thing inline like so:</p>
<p><img src="../../2008/9/authenticating-an-otr-user-in-adium/Status-Bar-SMP-Question-and-answer.png" alt="Image"></p>
<p>I especially like the fact that this gives lots of practical information to the user - even if it is still very wordy and does not solve the race condition of who will actually ask the question.</p>
<p>Therefore we decided to go with the first aproach pictured above.</p>
<p>There is of course more to this GUI than just the pretty pictures shown above. A few more things come to mind, that we think are very important:</p>
<ul>
<li>The normal chat window can and should be used as a feedback and instruction window. (With help messages clearly marked as such of course.) We want to use this to show some initial help when the "Verify" button is clicked and the authentication process is started and also at least when the authentication process fails multiple times, to provide additional help and tips as to how to overcome this situation.</li>
<li>Whenever the user types the secret word in the normal chat we want to either clearly notify the user that he has just compromised his password exchange and needs to choose a new question and answer (also if it is in the recent history) or we'd like to prevent the sending of the message (perhaps with a dialog box that also allows to proceed if that is really wanted).</li>
</ul>
<p>One unsolved problem is, that when the authentication fails multiple times, we need to find a good compromise between teaching the user about ways to prevent errors and making him aware of the possibility that there may be a man in the middle attack taking place.</p>
<p>Of course, just as the last time: Feedback welcome.</p>
<p><a href="http://trac.adiumx.com/wiki/OTREncryption">Here's the rest of the work</a></p>

    </section>
    
      <footer>
        <a href="../../2008/9/authenticating-an-otr-user-in-adium/">weiterlesen‚Ä¶</a>
      </footer>
    
  </article>

  
    
  <article class="blog-post">
    <header>
      <h2>
        <a href="../../2008/9/schadenfreude-ist/">
        Schadenfreude ist..
        </a>
      </h2>
      <p class="meta">
        written by Martin H√§cker on <time datetime="2008-09-03">Wednesday, September 3, 2008</time>
      </p>
    </header>

    <section class="blog-post-body">
      <p><a href="http://www.mactomster.de/2008/08/29/pc-vs-mac-zu-frueh-gelaestert/">... die sch√∂nste freude.</a></p>
<p>Stimmt einfach. :)</p>

    </section>
    
      <footer>
        <a href="../../2008/9/schadenfreude-ist/">weiterlesen‚Ä¶</a>
      </footer>
    
  </article>

  
    
  <article class="blog-post">
    <header>
      <h2>
        <a href="../../2008/9/kryptographie-saugt/">
        Kryptographie saugt
        </a>
      </h2>
      <p class="meta">
        written by Martin H√§cker on <time datetime="2008-09-01">Monday, September 1, 2008</time>
      </p>
    </header>

    <section class="blog-post-body">
      <p>Und zwar gewaltig.</p>
<p>Heute hab ich eine Menge Zeit darauf verbrannt unserem Online-Update-System auf den Zahn zu f√ºhlen. Das arbeitet n√§mlich ganz hervorragend mit <a href="http://sparkle.andymatuschak.org/">Sparkle</a> um f√ºr unsere Applikation via <a href="http://connectedflow.com/appcasting/">Appcast</a> herunter zu laden, wenn eine neue Version ansteht. Und damit das auch sch√∂n sicher ist, nutzen wir ein kleines √∂ffentlich/privates Schl√ºsselp√§rchen um das abzusichern.</p>
<p>Nun ja, bis heute mittag - da hat es n√§mlich auf einmal aufgeh√∂rt und konnte die heruntergeladenen Dateien nicht mehr validieren.</p>
<p>Jetzt hatte ich nat√ºrlich das Problem, das ich an sich recht wenig von Crypto verstehe und erst recht wie man das von der shell aus einsetzt. Das wiederum hatte zur Folge, dass ich das nicht sofort auf der Shell nachvollziehen konnte und wir schon anfingen zu f√ºrchten das vielleicht unsere Schl√ºssel abgelaufen sind.</p>
<p>Gott sei dank war es aber doch was anderes - denn unser Proxy hatte fieser weise einfach eine alte Version des Appcasts gespeichert und stattdessen immer die ausgeliefert - was nat√ºrlich nicht funktionierte... Grumpf.</p>
<p>Note to self: N√§chstes mal gleich den ganzen Vorgang von Hand reproduzieren um zu sehen wo es schief l√§uft - und zwar angefangen von da wo das Programm anf√§ngt. (Auch wenn in diesem Fall die Fehlermeldung wirklich eher auf einen OpenSSL Fehler hindeutete).</p>
<p>Debuggen ist eben schwieriger als den Code zu schreiben. Ich vermute, weil man ihn daf√ºr <strong><em>wirklich</em></strong> verstehen muss - inklusive aller Fehler die man in seinem eigenen Verst√§ndnis hat.</p>
<p>P.S.: So Signiert und Validiert man ein File mit OpenSSL von der Kommandozeile:</p>
<div class="hll"><pre><span></span><span class="c1"># base 64 encoding to ease textual transmission</span>
openssl<span class="w"> </span>dgst<span class="w"> </span>-dss1<span class="w"> </span>-sign<span class="w"> </span>dsa_private_key.pem<span class="w"> </span>Important.rtf<span class="w"> </span><span class="p">|</span><span class="w"> </span>openssl<span class="w"> </span>enc<span class="w"> </span>-base64<span class="w"> </span>&gt;<span class="w"> </span>signature.sig
<span class="c1"># and decode again</span>
openssl<span class="w"> </span>enc<span class="w"> </span>-base64<span class="w"> </span>-d<span class="w"> </span>&lt;<span class="w"> </span>signature.sig<span class="w"> </span>&gt;<span class="w"> </span>decoded.signature.sig
<span class="c1"># and verify</span>
openssl<span class="w"> </span>dgst<span class="w"> </span>-dss1<span class="w"> </span>-verify<span class="w"> </span>dsa_public_key.pem<span class="w"> </span>-signature<span class="w"> </span>decoded.signature.sig<span class="w"> </span>Important.rtf
</pre></div>
<p>Einige Fallstricke: -dss1 und -sha1 erzeugen offenbar die gleichen Checksummen (man k√∂nnte also meinen das es der gleiche Algorithmus ist) die beiden digest modi werden aber in openssl offenbar unterschiedlich behandelt. Beim Signieren l√∂st das verwenden von -sha1 auch sch√∂n eine Fehlermeldung aus - wenn man beim √úberpr√ºfen aber -sha1 zu verwenden versucht, dann erh√§lt man nur den Hinweis dass die Verifikation gescheitert ist - an einem falschen public key. Seeehr hilfreich liebe Entwickler.</p>
<p>Wie man ein Schl√ºsselpaar erzeugt und vieles mehr <a href="http://www.madboa.com/geek/openssl/">gibts hier</a>.</p>

    </section>
    
      <footer>
        <a href="../../2008/9/kryptographie-saugt/">weiterlesen‚Ä¶</a>
      </footer>
    
  </article>

  
    
  <article class="blog-post">
    <header>
      <h2>
        <a href="../../2008/9/wo-ich-gerade-am-la-stern-bin/">
        Wo ich gerade am l√§stern bin
        </a>
      </h2>
      <p class="meta">
        written by Martin H√§cker on <time datetime="2008-09-01">Monday, September 1, 2008</time>
      </p>
    </header>

    <section class="blog-post-body">
      <p>Apple hat sich da ja einen richtigen Kracher geleistet mit ihrem <a href="http://www.apple.com/iphone/appstore/">App-Store</a>. Vor allem ist das Update-System absolut grandios gel√∂st.</p>
<p>Man geht einfach im iPhone auf den App-Store, dort in den Updates-Reiter und.... sieht nichts. Weil, da sind zwar die Updates. Aber eben nicht alle.</p>
<p>Ein Programm das ich mir gekauft hatte (<a href="http://www.culturedcode.com/things/">Things</a>, weil die UI einfach sehr, sehr gut ist) tauchte dort n√§mlich nicht auf - obwohl ich es sehns√ºchtig erwartete. Und das, obwohl der iTunes Store das Programm schon l√§ngst als upgedatet aufgelistet hat.</p>
<p>Tja, was tun? Letztlich habe ich mich dann daf√ºr entschieden, dass ich f√ºr 8 ‚Ç¨ auch das Programm einfach noch einmal herunterladen kann. Wenigstens kann ich dann die neue Version nutzen. Und kann so mal Probieren ob der App-Store nicht vielleicht einen Bug hat und mir den Preis nur f√§lschlicherweise anzeigt.</p>
<p>Gesagt getan - da kommt dann erst eine Warnung dass der Betrag jetzt direkt von meiner Kreditkarte abgezogen wird (gut, Kreditkarte hab ich nicht, aber das ist halt ne Amerikanische Firma) und dann... dann kommt der Dialog der mir erkl√§rt das ich das Produkt ja schon gekauft h√§tte und das Update daher kostenlos sei.</p>
<p>Pfffff. Wenn ich ein Update lade, dann will ich vorher wissen ob mich das Geld kostet! Vorher, nicht hinterher. Vielleicht.</p>
<p>Ganz gro√üe Klasse.</p>

    </section>
    
      <footer>
        <a href="../../2008/9/wo-ich-gerade-am-la-stern-bin/">weiterlesen‚Ä¶</a>
      </footer>
    
  </article>

  
    
  <article class="blog-post">
    <header>
      <h2>
        <a href="../../2008/8/kontrollieren-welche-libraries-ein-programm-la-dt/">
        Kontrollieren welche Libraries ein Programm l√§dt
        </a>
      </h2>
      <p class="meta">
        written by Martin H√§cker on <time datetime="2008-08-29">Friday, August 29, 2008</time>
      </p>
    </header>

    <section class="blog-post-body">
      <p>ist beim Entwickeln ein echtes Problem.</p>
<p>Frameworks unter Mac OS X werden schlie√ülich so gelinkt, das jeder Framework den Pfad enth√§lt, an dem er sp√§ter einmal leben wird - und dieser Pfad wird dann in die Applikation eingetragen die ihn laden m√∂chte.</p>
<p>Das ist bl√∂d, wenn man Frameworks in <code>/Library/Frameworks/</code> installiert, bei der Entwicklung dann aber mal eine andere Version ausprobieren will oder muss. Auch klassisch ist, dass ein Framework der von Apple kommt zu alt ist und man sicherstellen muss, das ein eigener Framework stattdessen verwendet wird, der Bugfixes enth√§lt.</p>
<p>Schwierig.</p>
<p>Nunja, man macht das unter OS X mit dem √Ñquivalent des Linux Konstrukts <code>LD_LIBRARY_PATH</code>, also diversen Umgebungsvariablen, mit denen man das Verhalten des dynamischen linkers beeinflussen kann. Spa√üigerweise hat Apple das verhalten des dynamischen Linkers unter Tiger (10.4) ver√§ndert, dass er sich jetzt genauso verh√§lt wie unter Leopard (10.5) - zumindest sagt mein Ged√§chtnis andere Dinge als die 10.4 manpage von <code>dyld</code>.</p>
<p>Also sind jetzt eigentlich nur noch zwei Umgebungsvariablen interessant:</p>
<ul>
<li><code>DYLD_FRAMEWORK_PATH</code> wenn man etwas laden will, bevor die Pfade verwendet werden die in der Applikation f√ºr einen Framework stehen -&gt; also um einen Framework zu √ºberschreiben.</li>
<li><code>DYLD_FALLBACK_FRAMEWORK_PATH</code> wenn man etwas nachladen will, nachdem es an den vorgegebenen Pfaden nicht gefunden wurde. Die Manpage ist mir da noch nicht 100% klar - es wirkt fast so, als k√∂nnte man dyld auch daf√ºr verwenden eine neuere Version anzugeben, die nur genutzt wird, wenn in der alten ein bestimmtes Symbol nicht gefunden wurde - das konnte ich aber noch nicht testen (und kommt mir auch komisch vor).</li>
</ul>
<p>Also: kennen sollte man die - das gibt viel flexibilit√§t.</p>

    </section>
    
      <footer>
        <a href="../../2008/8/kontrollieren-welche-libraries-ein-programm-la-dt/">weiterlesen‚Ä¶</a>
      </footer>
    
  </article>

  
    
  <article class="blog-post">
    <header>
      <h2>
        <a href="../../2008/8/obfuscated-objc-oder-wie-macht-man-konstanten/">
        Obfuscated Objc - oder - wie macht man Konstanten?
        </a>
      </h2>
      <p class="meta">
        written by Martin H√§cker on <time datetime="2008-08-27">Wednesday, August 27, 2008</time>
      </p>
    </header>

    <section class="blog-post-body">
      <p>Ist ja eigentlich nicht schwer, man braucht lediglich eine Definition wie diese</p>
<div class="hll"><pre><span></span><span class="cp">#define kIOHIDVendorIDKey @&quot;VendorID&quot;</span>
<span class="k">const</span><span class="w"> </span><span class="bp">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">windowName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">@&quot;Morgens&quot;</span>
</pre></div>
<p>Einziges Problem - immer wieder hat man vom System konstante C-Strings, die man aber als Objc-Strings ben√∂tigt.</p>
<p>Interessanterweise hat der Compiler √ºberhaupt kein Problem das hier zu machen:</p>
<div class="hll"><pre><span></span><span class="cp">#define kIOHIDVendorIDKey &quot;VendorID&quot;</span>
<span class="c1">// ...</span>
<span class="p">[</span><span class="n">matchingDict</span><span class="w"> </span><span class="n">setValue</span><span class="o">:</span><span class="p">[</span><span class="bp">NSNumber</span><span class="w"> </span><span class="n">numberWithInt</span><span class="o">:</span><span class="n">entry</span><span class="o">-&gt;</span><span class="n">Vendor_ID</span><span class="p">]</span><span class="w"> </span>
<span class="w">       </span><span class="nl">forKey</span><span class="p">:</span><span class="w"> </span><span class="p">@</span><span class="n">kIOHIDVendorIDKey</span><span class="p">];</span><span class="w"> </span>

<span class="c1">// same, but more readable than</span>
<span class="p">[</span><span class="n">matchingDict</span><span class="w"> </span><span class="n">setValue</span><span class="o">:</span><span class="p">[</span><span class="bp">NSNumber</span><span class="w"> </span><span class="n">numberWithInt</span><span class="o">:</span><span class="n">entry</span><span class="o">-&gt;</span><span class="n">Vendor_ID</span><span class="p">]</span><span class="w"> </span>
<span class="w">       </span><span class="nl">forKey</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="bp">NSString</span><span class="w"> </span><span class="n">stringWithCString</span><span class="o">:</span><span class="n">kIOHIDVendorIDKey</span><span class="p">]];</span>
<span class="c1">// Also note that -stringWithCString is deprecated</span>
</pre></div>
<p>Oder mit anderen Worten man kann problemlos aus jeder C-String-Konstante eine Objc-String-Konstante machen, indem man einfach ein <strong><em>@</em></strong> davor schreibt.</p>
<p>Neat.</p>

    </section>
    
      <footer>
        <a href="../../2008/8/obfuscated-objc-oder-wie-macht-man-konstanten/">weiterlesen‚Ä¶</a>
      </footer>
    
  </article>

  
    
  <article class="blog-post">
    <header>
      <h2>
        <a href="../../2008/8/debugging-magic-in-cococa/">
        Debugging Magic in Cococa
        </a>
      </h2>
      <p class="meta">
        written by Martin H√§cker on <time datetime="2008-08-25">Monday, August 25, 2008</time>
      </p>
    </header>

    <section class="blog-post-body">
      <p>Erstaunlich aber wahr - viele Programmierer scheinen die Debugging-M√∂glichkeiten der Plattform ihrer Wahl nicht zu kennen.</p>
<p>Cocoa zum Beispiel. Viele Programmierer wissen nicht wie man Speicherl√∂cher effektiv f√§ngt.</p>
<p>Well, nicht Leaks - da kann man ja mit <a href="http://developer.apple.com/documentation/DeveloperTools/Conceptual/InstrumentsUserGuide/Built-InInstruments/chapter_9_section_8.html">ObjectAlloc</a> draufhauen und dann das Programm fixen.</p>
<p>Nein, viel problematischer als das sind die doppelten Befreiungen.</p>
<div class="hll"><pre><span></span><span class="kt">id</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[[</span><span class="bp">NSString</span><span class="w"> </span><span class="n">alloc</span><span class="p">]</span><span class="w"> </span><span class="n">initWithFormat</span><span class="o">:</span><span class="s">@&quot;foo&quot;</span><span class="p">];</span>
<span class="p">[</span><span class="n">foo</span><span class="w"> </span><span class="k">release</span><span class="p">];</span>
<span class="c1">// do something else</span>
<span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;foo is %d&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">foo</span><span class="w"> </span><span class="n">length</span><span class="p">]);</span><span class="w"> </span><span class="c1">// almost certainly bombs</span>
</pre></div>
<p>Die krachen n√§mlich fast immer - und dann sucht man sich tot was genau da eigentlich gekracht hat und woher das genau kommt. Tja.</p>
<p>Dabei kriegt man aus dem Programm eigentlich alle Informationen heraus die man braucht. Man muss nur jedes malloc mitz√§hlen und aufschreiben wo es passiert ist, dann jedes objekt das freigegeben wird, nicht wirklich freigeben, sondern lediglich markieren und dann bei einem weiteren Zugriff auf so ein Objekt eine Exception werfen.</p>
<p>Nichts leichter als das. :)</p>
<p>Man setze diese Environment Variablen (am besten auf einem Duplikat der zu entwanzenden Applikation in Xcode)</p>
<pre><code>MallocStackLogging YES
MallocStackLoggingNoCompact YES
NSZombieEnabled YES
NSDebugEnabled YES
</code></pre>
<p>Hat man dass macht die Runtime alles richtig. Jede allokation wird aufgezeichnet und jedes freigegebene Objekt durch einen Zombie ersetzt. Und der Meldet sich, sobald er f√ºr irgend etwas verwendet wird. N√§mlich so:</p>
<pre><code>2008-08-26 00:19:43.524 CrashTest[1663:817] *** -[CFString length]:
    message sent to deallocated instance 0x105440
</code></pre>
<p>H√§ngt man dann im Debugger, kann man von dort aus direkt diese Information abgreifen.</p>
<pre><code>(gdb) shell malloc_history 1663 0x105440

Call [2] [arg=16]: thread_a00ddfa0 |start | main | -[NSString initWithFormat:] |
 -[NSPlaceholderString initWithFormat:locale:arguments:] |
 _CFStringCreateWithFormatAndArgumentsAux | CFStringCreateCopy |
 __CFStringCreateImmutableFunnel3 | _CFRuntimeCreateInstance | malloc_zone_malloc
</code></pre>
<p>Die Syntax f√ºr malloc_history ist dabei <code>malloc_history pid address</code>.</p>
<p>Jetzt wei√ü man mit was f√ºr einem Objekt man es zu tun hat und man wei√ü wo es her kommt.</p>
<p>Nice! (Mehr unter <a href="http://developer.apple.com/technotes/tn2004/tn2124.html#SECMALLOC">Mac OS X Debugging Magic</a>)</p>
<p>p.s.: Ohne etwas Schelte an Apple geht es aber nicht. Das man sich da von Hand die Umgebungsvariablen einstellen muss - b√∂se. Zumal das noch an einer Custom Executable geschieht. Die sind n√§mlich nicht im Projektfile gespeichert, sondern in den Dateien die Xcode pro Benutzer anlegt. Das hat zur Folge, dass im Normalfall nicht ein Entwickler diese Dinge raussucht und dann alle anderen im Projekt dass als Tool nutzen k√∂nnen, sondern dass sich das jeder Selber einrichten und warten muss. Ach ja, und nat√ºrlich zeichnet malloc_history nur die allocs auf und nicht die frees - das w√§re n√§mlich noch praktischer, dann k√∂nnte man n√§mlich direkt kucken wo es das erste mal freigegeben wurde. Aber nein....</p>

    </section>
    
      <footer>
        <a href="../../2008/8/debugging-magic-in-cococa/">weiterlesen‚Ä¶</a>
      </footer>
    
  </article>

  
    
  <article class="blog-post">
    <header>
      <h2>
        <a href="../../2008/8/nstoolbaritem-whoes/">
        NSToolbarItem whoes
        </a>
      </h2>
      <p class="meta">
        written by Martin H√§cker on <time datetime="2008-08-21">Thursday, August 21, 2008</time>
      </p>
    </header>

    <section class="blog-post-body">
      <p>Kleines Detail, dass man wissen sollte.</p>
<p>NSToolbarItems sind etwas v√∂llig anderes als normale Controls. Sie sind n√§mlich keine. Sondern sie enthalten h√∂chstens welche - aber nur als View. Das hei√üt, wenn eine Toolbar z.b. auf "nur Text" geschaltet ist, dann hat das Item √ºberhaupt kein wissen dar√ºber was in dem NSView eigentlich passiert - und daher versucht es auch √ºberhaupt nicht etwas sinniges zu tun.</p>
<p>Unter Tiger zumindest. Da wird zwar alles sch√∂n angezeigt - aber machen tut das dann alles nix mehr. Unter Leopard ist es immerhin so, dass auf einen Klick die Toolbar wieder mit Bild angezeigt wird.</p>
<p>Tja und L√∂sen muss man das ganze dann so, dass man verstehen muss, das NSToolbarItems f√ºr die nur Text Darstellung ein NSMenuItem verwenden, dass man selbst anpassen muss. Steht nur in der Dokumentation lediglich als mini Absatz ohne Erkl√§rung <strong><em>wieso</em></strong> man das braucht.</p>
<p>Hrmpf. Naja. Immerhin macht es Sinn wenn man versteht was sie als Design gew√§hlt haben.</p>
<p>Aber wieso sie sich f√ºr dieses Design entschieden haben, verstehe ich absolut nicht. Sie h√§tten ja auch gleich ein NSControll als content nehmen k√∂nnen - und wenn das ein Target und eine Action hat dann einfach die wiederverwenden...</p>
<p>Aber neee....</p>

    </section>
    
      <footer>
        <a href="../../2008/8/nstoolbaritem-whoes/">weiterlesen‚Ä¶</a>
      </footer>
    
  </article>

  
  
  
    
  <div class="pagination">
    
      <a href="../19/">&laquo; Previous</a>
    
    | 20 |
    
      <a href="../21/">Next &raquo;</a>
    
  </div>

  

    </article>
    <footer class="container-fluid ">
      <ul class="nav">
  <li class="nav-item copyright">
    <span class="nav-link">&copy; 2025 <a href="../../../work/">Martin H√§cker</a></span>
  </li>
  
    
    <li class="nav-item imprint">
      <a class="nav-link" href="../../../meta/#imprint">
        Imprint
      </a></li>
  
    
    <li class="nav-item privacy-policy">
      <a class="nav-link" href="../../../meta/#privacy-policy">
        Privacy Policy
      </a></li>
  
    
    <li class="nav-item colophon">
      <a class="nav-link" href="../../../meta/#colophon">
        Colophon
      </a></li>
  
  <li class="ml-auto nav-item rss-feed">
    <a class="nav-link" href="../../../../blog/feed.xml">
      <img class="rss-icon" src=/static/rss.svg height=25 width=25>
      <span class="sr-only">RSS-Feed</span>
    </a>
  </li>
  <li class="nav-item license">
    <a class="nav-link" 
      rel="license" 
      target="_blank" 
      href="https://creativecommons.org/licenses/by-sa/4.0/deed"
    >
      <img 
        src="/static/cc-by-sa-88x31.png"
        alt="Creative Commons Attribution - Share Alike 4.0 International Lizense"
      >
    </a>
  </li>
</ul>
    </footer>
  </body>
</html>
